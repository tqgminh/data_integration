<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
  <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
</head>

<body>
  <div class="sidebar close">
    <div class="logo-details">
      <i class='fab fa-codepen'></i>
      <span class="logo_name">Nhóm 14 IT5420</span>
    </div>
    <ul class="nav-links">
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-book-alt'></i>
            <span class="link_name">Thể loại</span>
          </a>
          <i class='bx bxs-chevron-down arrow'></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Thể loại</a></li>
          <li onclick="brand('apple')"><a href="#">Iphone</a></li>
          <li onclick="brand('samsung')"><a href="#">Samsung</a></li>
          <li onclick="brand('oppo')"><a href="#">Oppo</a></li>
          <li onclick="brand('xiaomi')"><a href="#">Xiaomi</a></li>
          <li onclick="brand('other')"><a href="#">Hãng Khác</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-line-chart'></i>
            <span class="link_name">Giá</span>
          </a>
          <i class='bx bxs-chevron-down arrow'></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Giá</a></li>
          <li onclick="priceUnder(2000000)"><a href="#">Dưới 2 triệu</a></li>
          <li onclick="priceAbout(2000000, 4000000)"><a href="#">2 - 4 triệu</a></li>
          <li onclick="priceAbout(7000000, 13000000)"><a href="#">7 - 13 triệu</a></li>
          <li onclick="priceAbout(13000000, 20000000)"><a href="#">13 - 20 triệu</a></li>
          <li onclick="priceOver(20000000)"><a href="#">Trên 20 triệu</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-grid-alt'></i>
            <span class="link_name">Ram</span>
          </a>
          <i class='bx bxs-chevron-down arrow'></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Ram</a></li>
          <li onclick="ramUnder(2)"><a href="#">Dưới 2G</a></li>
          <li onclick="ramAbout(2, 4)"><a href="#">2G - 4G</a></li>
          <li onclick="ramAbout(4, 6)"><a href="#">4G - 6G</a></li>
          <li onclick="ramAbout(6, 8)"><a href="#">6G - 8G</a></li>
          <li onclick="ramOver(8)"><a href="#">Trên 8G</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-plug'></i>
            <span class="link_name">Bộ nhớ trong</span>
          </a>
          <i class='bx bxs-chevron-down arrow'></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Bộ nhớ trong</a></li>
          <li onclick="roomUnder(32)"><a href="#">Dưới 32G</a></li>
          <li onclick="roomAbout(32, 64)"><a href="#">32G - 64G</a></li>
          <li onclick="roomAbout(64, 128)"><a href="#">64G - 128G</a></li>
          <li onclick="roomOver(128)"><a href="#">Trên 128G</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-collection'></i>
            <span class="link_name">Kích thước màn hình</span>
          </a>
          <i class='bx bxs-chevron-down arrow'></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Kích thước màn hình</a></li>
          <li onclick="screenUnder(5)"><a href="#">Dưới 5 Inch</a></li>
          <li onclick="screenOver(5)"><a href="#">Từ 5 Inch trở lên</a></li>
        </ul>
      </li>
    </ul>
  </div>
  <section class="home-section dashboard">
    <div class="home-content">
      <i class='bx bx-menu'></i>
      <!-- <div class="search-box">
        <i class="uil uil-search"></i>
        <input type="text" placeholder="Search here...">
      </div> -->

      <form action="/tim-kiem" class="header__search" id="form-search">
        <i class="uil uil-search"></i>
        <input id="input-search" type="text" class="input-search" placeholder="Bạn tìm gì..." name="key"
          autocomplete="off" maxlength="100">
        <button class="button" type="submit" placeholder="Nhập vào...">
          Tìm kiếm
        </button>
        <div id="search-result" style="display: none;">
          <ul class="suggest_search">
          </ul>
        </div>
      </form>
    </div>
    <div class="dash-content">
      <div class="activity">
        <div class="activity-data">
          <div class="data names">
            <table id="phone"></table>
          </div>
        </div>
      </div>
    </div>
  </section>
  <script>
    let data;

    function displayToggle(params) {
      document.querySelectorAll('.property').forEach(element => {
        element.style.display = 'none';
      })
      document.getElementById(params).style.display = 'block';
    }

    function populateDataAndRender(listdata) {
      let tab =
        `<tr>
          <th>Tên</th>
          <th>Hãng</th>
          <th>Kích thước màn hình</th>
          <th>Công nghệ màn hình</th>
          <th>Cpu</th>
          <th>Ram</th>
          <th>Rom</th>
          <th>Pin</th>
          <th>Sim</th>
        </tr>`;
      for (let r of listdata) {
        tab += `<tr> 
                    <td><a herf='http://127.0.0.1:5500/web/index.html'>${r.ten}</a></td>
                    <td>${r.hang} </td>
                    <td>${r.kich_thuoc_man_hinh}</td> 
                    <td>${r.cong_nghe_man_hinh}</td>
                    <td>${r.cpu}</td>
                    <td>${r.ram}</td> 
                    <td>${r.bo_nho_trong}</td> 
                    <td>${r.pin}</td> 
                    <td>${r.sim}</td>
                </tr>`;
      }
      document.getElementById("phone").innerHTML = tab;
    }

    (function init() {
      try {
        document.querySelectorAll('.button').forEach(item => {
          item.addEventListener('click', e => {

            document.querySelectorAll('.button').forEach(item => {
              item.className = 'button';
            });
            item.className = 'button active'
          })
        })

        const search = document.getElementById('input-search')
        document.querySelector('#form-search').addEventListener('submit', e => {
          e.preventDefault();
          fetName(search.value)
        })
      } catch (err) {
        console.log(err);
      }


    })();

    async function fetName(ten) {
      const res = await fetch(`http://localhost:3000/api/phones?ten=${ten}`)
      data = await res.json();
      data = data.data;
      await populateDataAndRender(data);
    }

    function Hiii(id) {
      console.log('id:', id);
    }

    async function fetId(id) {
      console.log('id:', id);
      const res = await fetch(`http://localhost:3000/api/phones/${id}`)
      data = await res.json();
      data = data.data;
      console.log('res by Id:', data.data);
      await populateDataAndRender(data);
    }

    function brand(brand) {
      const rs = data.filter(phone => phone.hang === brand)
      populateDataAndRender(rs)
    }

    function ramUnder(ram) {
      const rs = data.filter(phone => phone.ram < ram)
      populateDataAndRender(rs)
    }

    function ramAbout(ram1, ram2) {
      const rs = data.filter(phone => (phone.ram >= ram1 && phone.ram < ram2))
      populateDataAndRender(rs)
    }

    function ramOver(ram) {
      const rs = data.filter(phone => phone.ram >= ram)
      populateDataAndRender(rs)
    }

    function priceUnder(price) {
      console.log('price:', price)
      const rs = data.filter(phone => phone.gia_moi < price)
      populateDataAndRender(rs)
    }

    function priceAbout(price1, price2) {
      const rs = data.filter(phone => phone.gia_moi >= price1 && phone.gia_moi < price2)
      populateDataAndRender(rs)
    }

    function priceOver(price) {
      const rs = data.filter(phone => phone.gia_moi >= price)
      populateDataAndRender(rs)
    }

    function roomUnder(room) {
      console.log('room:', room);
      const rs = data.filter(phone => phone.bo_nho_trong < room)
      populateDataAndRender(rs)
    }

    function roomAbout(room1, room2) {
      const rs = data.filter(phone => phone.bo_nho_trong >= room1 && phone.bo_nho_trong < room2)
      populateDataAndRender(rs)
    }

    function roomOver(room) {
      const rs = data.filter(phone => phone.bo_nho_trong >= room)
      populateDataAndRender(rs)
    }

    function screenUnder(screen) {
      const rs = data.filter(phone => phone.kich_thuoc_man_hinh < screen)
      populateDataAndRender(rs)
    }

    function screenOver(screen) {
      const rs = data.filter(phone => phone.kich_thuoc_man_hinh >= screen)
      populateDataAndRender(rs)
    }
  </script>
  <script src="app.js">
  </script>
</body>

</html>